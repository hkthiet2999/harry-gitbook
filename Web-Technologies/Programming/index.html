
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Harry Hoang">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>Programming - Harry Gitbook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#programming" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Harry Gitbook" class="md-header__button md-logo" aria-label="Harry Gitbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Harry Gitbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Programming
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/smoothkt4951/harry-gitbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../Web-Protocols/" class="md-tabs__link md-tabs__link--active">
        Web technologies
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../SVM-Git/Source-Version-Control/" class="md-tabs__link">
        SVM-Git
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Package-Management/composer/" class="md-tabs__link">
        Package Management
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Docker/Docker-Architecture/" class="md-tabs__link">
        Docker
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Redis/Redis/" class="md-tabs__link">
        Redis
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Message-Brokers/Message-Brokers/" class="md-tabs__link">
        Message Brokers
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../OOP/Object-Oriented-Programing/" class="md-tabs__link">
      OOP
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Database/Relationship-Keys-Cascade/" class="md-tabs__link">
        Database
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../ORM/Overview/" class="md-tabs__link">
        ORM
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Elasticsearch/Overview/" class="md-tabs__link">
        Elasticsearch
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Testing/Unit-Testing/" class="md-tabs__link">
        Testing
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Architecture/Monolith/" class="md-tabs__link">
        Architecture
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Harry Gitbook" class="md-nav__button md-logo" aria-label="Harry Gitbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Harry Gitbook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/smoothkt4951/harry-gitbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Web technologies
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Web technologies" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Web technologies
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Web-Protocols/" class="md-nav__link">
        Web Protocols
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../HTTP-Protocol/" class="md-nav__link">
        HTTP Protocol
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Web-server-and-proxy/" class="md-nav__link">
        Web server and proxy
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Programming
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Programming
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#processes-and-threads" class="md-nav__link">
    Processes and threads
  </a>
  
    <nav class="md-nav" aria-label="Processes and threads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    Concepts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-vs-thread" class="md-nav__link">
    Process vs. Thread
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    Error handling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts_1" class="md-nav__link">
    Concepts
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#error-handling-in-nodejs" class="md-nav__link">
    Error handling in Nodejs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-programming" class="md-nav__link">
    Async programming
  </a>
  
    <nav class="md-nav" aria-label="Async programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concepts_2" class="md-nav__link">
    Concepts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronous-vs-asynchronous-programming" class="md-nav__link">
    Synchronous vs. Asynchronous Programming
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asynchronous-programming-in-nodejs" class="md-nav__link">
    Asynchronous programming in NodeJs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    Memory management
  </a>
  
    <nav class="md-nav" aria-label="Memory management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concepts-and-memory-life-cycle" class="md-nav__link">
    Concepts and Memory life cycle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-management-with-garbage-collection" class="md-nav__link">
    Memory management with Garbage Collection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-memory-leaks" class="md-nav__link">
    Avoid Memory leaks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Supervisor%20and%20workers%20management/" class="md-nav__link">
        Supervisord and workers management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../RESTful/" class="md-nav__link">
        RESTful
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          SVM-Git
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SVM-Git" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          SVM-Git
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SVM-Git/Source-Version-Control/" class="md-nav__link">
        Source Version Control
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Package Management
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Package Management" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Package Management
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Package-Management/composer/" class="md-nav__link">
        Composer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Package-Management/npm/" class="md-nav__link">
        NPM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" data-md-state="indeterminate" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Docker" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Docker-Architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Docker-Objects/" class="md-nav__link">
        Docker Objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Volumes-PersistentData/" class="md-nav__link">
        Volumes - Persistent data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Network/" class="md-nav__link">
        Network - Port
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Environments/" class="md-nav__link">
        Environments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Docker-Compose/" class="md-nav__link">
        Docker Compose
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Practice/" class="md-nav__link">
        Practice with Docker
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" data-md-state="indeterminate" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Redis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Redis" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Redis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Redis/Redis/" class="md-nav__link">
        Redis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" data-md-state="indeterminate" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Message Brokers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Message Brokers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Message Brokers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Message-Brokers/Message-Brokers/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Message-Brokers/RabbitMQ/" class="md-nav__link">
        RabbitMQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Message-Brokers/SNS-SQS/" class="md-nav__link">
        SNS/SQS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Message-Brokers/Work-Queues/" class="md-nav__link">
        Work Queues
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Message-Brokers/Publish-Subscribe/" class="md-nav__link">
        Publish/Subscribe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Message-Brokers/Routing/" class="md-nav__link">
        Routing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Message-Brokers/Topics-Exchange-Channel/" class="md-nav__link">
        Topics, Exchange, Channel
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Object-Oriented-Programing/" class="md-nav__link">
        OOP
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" data-md-state="indeterminate" type="checkbox" id="__nav_9" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Database
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Database" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Database
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Database/Relationship-Keys-Cascade/" class="md-nav__link">
        Relationship, Primary/Foreign keys, Cascade
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Database/Data-types/" class="md-nav__link">
        Data types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Database/Index-Constraints-Unique/" class="md-nav__link">
        Index, Constraints, Unique
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Database/Queries/" class="md-nav__link">
        Queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Database/Transactions-ACID/" class="md-nav__link">
        Transactions - ACID
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Database/Schema/" class="md-nav__link">
        Schema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Database/Deadlock/" class="md-nav__link">
        Deadlock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Database/Locking-Isolation/" class="md-nav__link">
        Locking / Isolation Level
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Database/Timestamp/" class="md-nav__link">
        Time stamp
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" data-md-state="indeterminate" type="checkbox" id="__nav_10" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          ORM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ORM" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          ORM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ORM/Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ORM/Transactions/" class="md-nav__link">
        Transactions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ORM/Migrations-Seeder/" class="md-nav__link">
        Migrations / Seeder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ORM/Relations-Cascade/" class="md-nav__link">
        Relations - Cascade
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ORM/Decorator-Anotation/" class="md-nav__link">
        Annotation and Decorator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ORM/Lazy-Eager-Loading/" class="md-nav__link">
        Lazy / Eager loading
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ORM/DoctrineORM/" class="md-nav__link">
        Doctrine ORM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ORM/TypeORM/" class="md-nav__link">
        TypeORM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" data-md-state="indeterminate" type="checkbox" id="__nav_11" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Elasticsearch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Elasticsearch" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Elasticsearch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Elasticsearch/Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Elasticsearch/Index-Type-Document/" class="md-nav__link">
        Index, Type, Document
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Elasticsearch/Data-Types/" class="md-nav__link">
        Data types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Elasticsearch/Mapping/" class="md-nav__link">
        Mapping
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Elasticsearch/Analyzer/" class="md-nav__link">
        Analyzer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Elasticsearch/Queries-Sort/" class="md-nav__link">
        Queries / Sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Elasticsearch/Aggregation/" class="md-nav__link">
        Aggregation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" data-md-state="indeterminate" type="checkbox" id="__nav_12" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          Testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Testing" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Testing/Unit-Testing/" class="md-nav__link">
        Unit Test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Testing/Functional-Testing/" class="md-nav__link">
        Functional Test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Testing/Test-Coverage/" class="md-nav__link">
        Test coverage
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" data-md-state="indeterminate" type="checkbox" id="__nav_13" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_13">
          Architecture
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Architecture" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Architecture
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Architecture/Monolith/" class="md-nav__link">
        Monolith
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Architecture/Microservices/" class="md-nav__link">
        Microservices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Architecture/Saga-CQRS-pattern/" class="md-nav__link">
        Saga / CQRS Pattern
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#processes-and-threads" class="md-nav__link">
    Processes and threads
  </a>
  
    <nav class="md-nav" aria-label="Processes and threads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    Concepts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-vs-thread" class="md-nav__link">
    Process vs. Thread
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    Error handling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts_1" class="md-nav__link">
    Concepts
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#error-handling-in-nodejs" class="md-nav__link">
    Error handling in Nodejs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-programming" class="md-nav__link">
    Async programming
  </a>
  
    <nav class="md-nav" aria-label="Async programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concepts_2" class="md-nav__link">
    Concepts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronous-vs-asynchronous-programming" class="md-nav__link">
    Synchronous vs. Asynchronous Programming
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asynchronous-programming-in-nodejs" class="md-nav__link">
    Asynchronous programming in NodeJs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    Memory management
  </a>
  
    <nav class="md-nav" aria-label="Memory management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concepts-and-memory-life-cycle" class="md-nav__link">
    Concepts and Memory life cycle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-management-with-garbage-collection" class="md-nav__link">
    Memory management with Garbage Collection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-memory-leaks" class="md-nav__link">
    Avoid Memory leaks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/smoothkt4951/harry-gitbook/edit/master/docs/Web-Technologies/Programming.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="programming">Programming<a class="headerlink" href="#programming" title="Permanent link">&para;</a></h1>
<ul>
<li>Processes and threads</li>
<li>Error handling</li>
<li>Async programming</li>
<li>Memory management</li>
</ul>
<h2 id="processes-and-threads">Processes and threads<a class="headerlink" href="#processes-and-threads" title="Permanent link">&para;</a></h2>
<h3 id="concepts">Concepts<a class="headerlink" href="#concepts" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>program</code>: tồn tại trong bộ nhớ hoặc ở trạng thái nghỉ, <code>program</code> có thể là một tập lệnh dựa trên văn bản (tệp DOS, tập lệnh Windows Powershell, tập lệnh bash shell, Javascript, v.v.) hoặc tập lệnh thực thi dựa trên nhị phân (.exe).</p>
</li>
<li>
<p><code>process</code>:  Là một <code>program</code> được nạp vào bộ nhớ để bộ xử lý, thực thi. (<em>loaded into the memory to be executed by the processor.</em>)</p>
</li>
<li>
<p><code>thread</code>: Là đơn vị thực thi tối thiểu của các đoạn mã do hệ điều hành quản lý. Trong hệ điều hành, một <code>process</code> có thể được chia thành các  <code>thread</code>.</p>
</li>
</ul>
<h3 id="process-vs-thread">Process vs. Thread<a class="headerlink" href="#process-vs-thread" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../images/process-vs-thread.png" /></p>
<table>
<thead>
<tr>
<th>Comparison Basis</th>
<th>Process</th>
<th>Thread</th>
</tr>
</thead>
<tbody>
<tr>
<td>Definition</td>
<td>Là một <code>program</code> đang được thực thi</td>
<td>Là một <code>process</code> được chia nhỏ, có thể được quản lý độc lập bởi <code>schedular</code></td>
</tr>
<tr>
<td>Context switching time</td>
<td>Đòi hỏi nhiều thời gian hơn để chuyển đổi context vì chúng nặng hơn</td>
<td>Yêu cầu ít thời gian hơn để chuyển đổi context vì chúng nhẹ hơn</td>
</tr>
<tr>
<td>Memory Sharing</td>
<td>Hoàn toàn độc lập và không chia sẻ bộ nhớ</td>
<td>Có thể chia sẻ một số bộ nhớ với các <code>thread</code> ngang hàng của nó.</td>
</tr>
<tr>
<td>Communication</td>
<td>Đòi hỏi nhiều thời gian hơn</td>
<td>Yêu cầu ít thời gian hơn</td>
</tr>
<tr>
<td>Blocked</td>
<td>Trong một nhóm <code>process</code> ngang cấp, nếu một <code>process</code> bị block, các <code>process</code> còn lại có thể tiếp tục thực thi.</td>
<td>Nếu một <code>thread</code> bị block, tất cả các <code>thread</code> ngang hàng của nó cũng bị block.</td>
</tr>
<tr>
<td>Resource Consumption</td>
<td>Yêu cầu nhiều tài nguyên hơn</td>
<td>Cần ít tài nguyên hơn</td>
</tr>
<tr>
<td>Dependency</td>
<td>Các <code>process</code> độc lập với nhau</td>
<td><code>thread</code> là các phần của một <code>process</code> và do đó chúng phụ thuộc vào <code>process</code></td>
</tr>
<tr>
<td>Data and Code sharing</td>
<td>Có data và code segment độc lập</td>
<td>Một <code>thread</code> chia sẻ data segment, code segment, file, v.v... với các <code>thread</code> ngang hàng</td>
</tr>
<tr>
<td>Treatment by OS</td>
<td>Tất cả các <code>process</code> khác nhau được hệ điều hành xử lý riêng biệt.</td>
<td>Tất cả các <code>thread</code> ngang hàng nhau được hệ điều hành coi như một tác vụ duy nhất.</td>
</tr>
<tr>
<td>Time for creation</td>
<td>Tạo tốn nhiều thời gian hơn</td>
<td>Tạo tốn ít thời gian hơn</td>
</tr>
<tr>
<td>Time for termination</td>
<td>Cần nhiều thời gian hơn để kết thúc</td>
<td>Cần ít thời gian hơn để kết thúc</td>
</tr>
</tbody>
</table>
<h2 id="error-handling">Error handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h2>
<p><img alt="err" src="https://j.gifs.com/0YP4K3.gif" /></p>
<h2 id="concepts_1">Concepts<a class="headerlink" href="#concepts_1" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Khi một <code>process</code> thực thi bị thất bại thì <code>program</code> sẽ bị <code>error</code>. Và  quá trình đi từ dự đoán, phát hiện và giải quyết các <code>error</code> này, giúp cho các <code>process</code> thực thi thành công được gọi là <code>Error handling</code>.</p>
</li>
<li>
<p>Quá trình <code>Error handling</code> bao gồm phần cứng và phần mềm. Việc xử lý lỗi thường được phát hiện bằng việc trả về các <code>Error code</code> hoặc các <code>Error message</code> cụ thể. </p>
</li>
<li>
<p>Trong quá trình Runtime của <code>program</code>, có thể xảy ra tình trạng lỗi qua các <code>exception events</code>, dẫn tới <code>error</code>: dữ liệu không hợp lệ, không tìm thấy file, tràn bộ nhớ v.v. Và để xử lý tình trạng này, người ta dùng kỹ thuật <code>Exception Handling</code> - một kỹ thuật xử lý các <code>Runtime Error</code>, <code>Exception Events</code>. Kỹ thuật này giúp duy trì các <code>process</code> chạy theo đúng nghĩa của nó, nếu có lỗi thì sẽ <code>catch</code> các <code>Error code</code> hoặc các <code>Error message</code> cụ thể. </p>
</li>
</ul>
<h3 id="error-handling-in-nodejs">Error handling in Nodejs<a class="headerlink" href="#error-handling-in-nodejs" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../images/err.jpg" /></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Errors in Node.js are handled through exceptions.
</code></pre></div>
<ul>
<li>Một <code>exception</code> được tạo bằng cách sử dụng từ khóa <code>throw</code>: 
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">throw</span> <span class="nx">value</span>
</code></pre></div></li>
<li>Sau khi JavaScript thực thi dòng này, chương trình tạm dừng và lỗi được gửi tới <code>exception handler</code> - một câu lệnh <code>try/catch</code>:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">try</span> <span class="p">{</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>  <span class="c1">//lines of code</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span>
</code></pre></div>
<ul>
<li>
<p>Trong Node.js, không throw <code>strings</code>, mà là throw <code>Error objects</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">throw</span> <span class="ow">new</span> <span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Ran out of coffee&#39;</span><span class="p">)</span>
</code></pre></div>
hoặc 
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kd">class</span> <span class="nx">NotEnoughCoffeeError</span> <span class="k">extends</span> <span class="ne">Error</span> <span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>  <span class="c1">//...</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="p">}</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="k">throw</span> <span class="ow">new</span> <span class="nx">NotEnoughCoffeeError</span><span class="p">()</span>
</code></pre></div></p>
</li>
<li>
<p><code>Error handling</code> trong NodeJS với <code>async/await</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">async</span> <span class="kd">function</span> <span class="nx">someFunction</span><span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>  <span class="k">try</span> <span class="p">{</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="k">await</span> <span class="nx">someOtherFunction</span><span class="p">()</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>  <span class="p">}</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="p">}</span>
</code></pre></div></p>
</li>
</ul>
<h2 id="async-programming">Async programming<a class="headerlink" href="#async-programming" title="Permanent link">&para;</a></h2>
<h3 id="concepts_2">Concepts<a class="headerlink" href="#concepts_2" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>Javascript Engine</code>:  <code>V8 Javascript Engine</code> - optimized version,  bao gồm hai thành phần chính:
    <img alt="" src="../images/js-engine.png" /></p>
<ul>
<li><code>Call Stack</code>: stack chứa các lời gọi hàm khi code được thực thi.</li>
<li><code>Memory Heap</code>: Cấp phát bộ nhớ cho các <code>process</code></li>
</ul>
</li>
<li>
<p><code>Event Loop</code> và <code>Callback Queue</code>: Bên cạnh <code>Javascript Engine</code>, browser còn cung cấp các <code>Node APIs</code>, một <code>Event Loop</code> và một <code>Callback Queue</code>. Chúng chạy trên các <code>thread</code> riêng và được browser kiểm soát đồng thời (<code>concurrency</code>). </p>
<ul>
<li>Các hàm <code>async callback</code> sẽ được thêm vào <code>Callback Queue</code>. </li>
<li>Nhiệm vụ của <code>Event Loop</code> là đợi đến khi <code>Call Stack</code> rỗng, và quay lại kiểm tra trong <code>Callback Queue</code> có gì không, nếu có thì lấy lần lượt chúng đẩy vào trong <code>Call Stack</code> để chạy tiếp.</li>
</ul>
</li>
</ul>
<p><img alt="" src="https://freetuts.net/upload/tut_post/images/2020/02/24/2186/eventloop-javascript.gif" /></p>
<h3 id="synchronous-vs-asynchronous-programming">Synchronous vs. Asynchronous Programming<a class="headerlink" href="#synchronous-vs-asynchronous-programming" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>Asynchronous programming</code>: Về bản chất, nó thực hiện các request đồng thời, ngay cả khi chúng ở các chức năng khác nhau. Một single thread sẽ được handle multiple-requests trong <code>event-loop</code>. Vì vậy, việc một request bị reject sẽ không ảnh hưởng đến request khác.NodeJS cho phép thực hiện lập trình bất đồng bộ. Khi bất đồng bộ thực thi tất cả dòng code cùng một lúc.</p>
</li>
<li>
<p><code>Synchronous programming</code>: Tải tài nguyên một cách đơn lẻ và tuần tự, như vậy khi 1 tài nguyên trong hệ thống <code>có phân cấp</code> không tải được, thì những tài nguyên bên dưới nó sẽ không tải được luôn. Với NodeJS, ở chế độ đồng bộ thực thi từng dòng và tiến hành thực thi dòng tiếp theo khi dòng hiện tại đã thực thi xong.</p>
</li>
</ul>
<p><strong><em>Synchronous</em></strong></p>
<ul>
<li>
<p>Tải tài nguyên một cách đơn lẻ và tuần tự, khi một tài nguyên trong hệ thống có phân cấp không tải được, thì những tài nguyên bên dưới nó sẽ không response.</p>
</li>
<li>
<p>Các request sẽ được hoạt động đồng bộ với giao thức đa luồng.</p>
</li>
<li>
<p>Mỗi <code>thread</code> sẽ xử lý 1 request riêng biệt, độc lập. Vì vậy, mỗi thread sẽ có 1 khoảng thời gian <code>execution</code> và <code>loads completely</code> trước khi thực hiện <code>event</code> tiếp theo. Do đó, việc <code>execution</code> và <code>loads completely</code> trong một thread sẽ <code>block</code> các thread khác, các thread khác phải đợi thread trước nó done rồi mới tới lượt <code>execution</code> và <code>loads completely</code>.</p>
</li>
</ul>
<p><img alt="" src="../images/sync.png" /></p>
<ul>
<li>Lập trình đồng bộ đảm bảo rằng phía client sẽ nhận được response từ request đầu tiên trước khi thực hiện request tiếp theo (FIFS). Điều này có thể dẫn đến sự chậm trễ không cần thiết và ảnh hưởng xấu đến UX.</li>
</ul>
<p><strong><em>Asynchronous</em></strong></p>
<ul>
<li>
<p>Trong Asynchronous Programming, một apps sẽ serve các request và response bằng cách sử dụng giao thức non-blocking I/O. </p>
</li>
<li>
<p>Khác với lập trình đồng bộ, một chương trình không đồng bộ không thực hiện các actions một cách tuần tự, thứ bậc. Vì vậy, chương trình sẽ không đợi thực hiện một request trước khi trả lời một request khác.</p>
</li>
<li>
<p>Về bản chất, nó thực hiện các request đồng thời, ngay cả khi chúng ở các chức năng khác nhau. Từ đó mang lại hiệu quả là một ứng dụng được phát triển bằng Asynchronous Programming sẽ chỉ tải toàn bộ nội dung của nó một lần.</p>
</li>
<li>
<p>Một single thread xử lý nhiều request trong một <code>event loop</code>. Vì vậy, việc một request không thành công sẽ không ảnh hưởng đến request kia.</p>
</li>
</ul>
<p><img alt="" src="../images/async.png" /></p>
<ul>
<li>Vì asynchronous loading theo kiểu non-blocking, nên các ứng dụng web hoạt động theo nguyên tắc này có thể trở thành các single-page applications.</li>
</ul>
<h3 id="asynchronous-programming-in-nodejs">Asynchronous programming in NodeJs<a class="headerlink" href="#asynchronous-programming-in-nodejs" title="Permanent link">&para;</a></h3>
<ul>
<li>Một chương trình được thực thi bất đồng bộ đem lại trải nghiệm, tốc độ xử lý tốt hơn, tuy nhiên chính vì sự bất nguyên tắc, không có thứ tự thực hiện như vậy nên việc quản lý các tiến trình trở nên phức tạp và khó khăn hơn, xét ví dụ dưới đây:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kd">let</span> <span class="nx">content</span><span class="p">;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="k">try</span> <span class="p">{</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>  <span class="nx">content</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;file.md&#39;</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">);</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="p">}</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>
<p>Vấn đề ở đây là các <code>thread</code> sẽ bị block khi <code>fs.readFileSync()</code> đang thực thi, thực thi xong thì mới chạy tới các <code>thread</code> khác, tốn perfomance, thời gian. VD nếu có lỗi trong quá trình đọc file, phải đợi đến khi đọc file xong mới log ra được lỗi.</p>
</li>
<li>
<p>Cách giải quyết ở đây là sử dụng <code>callback</code> truyền vào <code>fs.readFileSync()</code>:</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;start reading a file...&#39;</span><span class="p">);</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">&#39;file.md&#39;</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;error happened during reading the file&#39;</span><span class="p">)</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>    <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>  <span class="p">}</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="p">});</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;end of the file&#39;</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>Với ví dụ này, Ta có thể dùng <code>Promise</code> để đọc nhiều file:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="kd">function</span> <span class="nx">readMultipleFile</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>  <span class="k">return</span> <span class="ow">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">content</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>        <span class="k">return</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>      <span class="p">}</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>      <span class="nx">resolve</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>    <span class="p">});</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>  <span class="p">});</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="p">}</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span><span class="nx">readMultipleFile</span><span class="p">(</span><span class="s2">&quot;file1&quot;</span><span class="p">),</span> <span class="nx">readFile</span><span class="p">(</span><span class="s2">&quot;file2&quot;</span><span class="p">),</span> <span class="nx">readFile</span><span class="p">(</span><span class="s2">&quot;file3&quot;</span><span class="p">)])</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">content</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">content</span><span class="p">))</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">));</span>
</code></pre></div>
<ul>
<li>
<p>Việc dùng <code>callback</code> hay <code>Promise</code> như trên có thể dẫn tới hiện tượng <a href="https://tutorialzine.com/media/2017/07/callback-hell.jpg">callback hell</a> và <code>Promise chain</code>. Và tính năng <code>Async/Await</code> trong Javascript ra đời để giải quyết tình trạng trên, giúp chúng ta làm việc với các hàm bất đồng bộ ngắn gọn và dễ hiểu hơn. </p>
</li>
<li>
<p><code>Async/Await</code> được xây dựng trên <code>Promise</code> và tương thích với tất cả các <code>Promise</code> dựa trên API, trong đó:</p>
<ul>
<li>
<p><code>Async</code> - khai báo một hàm bất đồng bộ kiểu 
    <div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">async</span> <span class="kd">function</span> <span class="nx">someName</span><span class="p">(){...})</span>
</code></pre></div></p>
<ul>
<li>Tự động biến đổi một hàm thông thường thành một <code>Promise</code>.</li>
<li>Khi gọi tới hàm <code>async</code> nó sẽ xử lý mọi thứ và được trả về kết quả trong hàm của nó.</li>
<li><code>Async</code> cho phép sử dụng <code>Await</code>.</li>
</ul>
</li>
<li>
<p>Await - tạm dừng việc thực hiện các hàm async.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">someAsyncCall</span> <span class="p">(){...}</span>
</code></pre></div></p>
<ul>
<li>Khi được đặt trước một <code>Promise</code>, nó sẽ đợi cho đến khi <code>Promise</code> kết thúc và trả về kết quả.</li>
<li><code>Await</code> chỉ làm việc với <code>Promise</code>, nó không hoạt động với <code>callback</code>.</li>
<li><code>Await</code> chỉ có thể được sử dụng bên trong các function <code>async</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="kd">const</span> <span class="nx">readFileAsync</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">file</span><span class="p">){</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="k">try</span> <span class="p">{</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>        <span class="kd">let</span> <span class="nx">content</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>        <span class="k">return</span> <span class="nx">content</span><span class="p">;</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>        <span class="k">return</span> <span class="nx">error</span><span class="p">;</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="p">}</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="p">}</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="kd">const</span> <span class="nx">contents</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span><span class="nx">readFileAsync</span><span class="p">(</span><span class="s2">&quot;file1&quot;</span><span class="p">),</span> <span class="nx">readFileAsync</span><span class="p">(</span><span class="s2">&quot;file2&quot;</span><span class="p">),</span> <span class="nx">readFileAsync</span><span class="p">(</span><span class="s2">&quot;file3&quot;</span><span class="p">)]);</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">contents</span><span class="p">);</span>
</code></pre></div>
<h2 id="memory-management">Memory management<a class="headerlink" href="#memory-management" title="Permanent link">&para;</a></h2>
<h3 id="concepts-and-memory-life-cycle">Concepts and Memory life cycle<a class="headerlink" href="#concepts-and-memory-life-cycle" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Mọi ứng dụng đều cần bộ nhớ để hoạt động bình thường. <code>Memory management</code> - <code>Quản lý bộ nhớ</code> là quá trình phân phối dynamically các <code>memory chunks</code> cho <code>programs</code> khi chúng cần và giải phóng để thằng khác xài khi <code>programs</code> không còn cần bộ nhớ đó nữa. Việc quản lý bộ nhớ ở Application-level có thể là thủ công hoặc tự động.</p>
</li>
<li>
<p>Các ngôn ngữ bậc thấp như C, quản lý bộ nhớ thủ công như <code>malloc()</code> và <code>free()</code>. Việc quản lý bộ nhớ thủ công có thể gây ra một số lỗi lớn cho ứng dụng, chẳng hạn việc bộ nhớ bị rò rỉ khi không gian bộ nhớ đã sử dụng không bao giờ được giải phóng.</p>
</li>
<li>
<p>Trong JavaScript hay NodeJs đều hỗ trợ <code>garbage collector</code> - trình thu gom rác, tự động cấp phát bộ nhớ khi các đối tượng được tạo và giải phóng nó khi chúng không được sử dụng nữa.</p>
</li>
<li>
<p><code>Memory life cycle</code>: Bất kể ngôn ngữ lập trình gì, <code>Memory life cycle</code> luôn giống nhau:</p>
</li>
<li>
<p>Phân bổ bộ nhớ cho <code>process</code></p>
</li>
<li><code>process</code> sử dụng bộ nhớ được cấp phát (đọc, ghi)</li>
<li>Giải phóng bộ nhớ được cấp phát khi <code>process</code> không cần thiết nữa.</li>
</ul>
<h3 id="memory-management-with-garbage-collection">Memory management with Garbage Collection<a class="headerlink" href="#memory-management-with-garbage-collection" title="Permanent link">&para;</a></h3>
<ul>
<li><code>Garbage collection</code>: Là cơ chế thu dọn và xóa sổ những object/giá trị không còn được dùng tới, trả lại bộ nhớ để dùng cho việc khác. <code>GC</code> của V8 là một <a href="https://www.memorymanagement.org/glossary/g.html#term-generational-garbage-collection">Generational Garbage Collector</a>. Trong quá trình thực thi, các giá trị (biến, object,...) được tạo ra nằm trong <code>Memory Heap</code>. V8 chia <code>Memory Heap</code> ra làm nhiều khu vực, trong đó có hai khu vực chính là <code>new-space</code>- chứa các đối tượng nhỏ, có vòng đời ngắn và <code>old-space</code> - chứa các thành phần sống dai hơn, bự hơn.</li>
</ul>
<p><img alt="" src="../images/memory-heap.png" /></p>
<p><strong>Cơ chế hoạt động:</strong></p>
<ul>
<li>
<p>Khi chúng ta khai báo một giá trị mới, giá trị này sẽ được cấp phát nằm rải rác trong khu vực <code>new-space</code>, khu vực này có một kích thước nhất định, thường là rất nhỏ (khoảng 1MB đến 8MB, tùy vào cách hoạt động của ứng dụng). Việc khai báo như thế này tạo ra nhiều khoảng trống không thể sử dụng được trong bộ nhớ.</p>
</li>
<li>
<p>Khi <code>new-space</code> đầy, thì thuật toán <code>scavenge</code> sẽ được kích hoạt để dọn dẹp các vùng nhớ "chết", giải phóng mặt bằng, có thể sẽ gom góp các vùng nhớ rời rạc lại gần nhau cho hợp lý. Vì <code>new-space</code> rất nhỏ, nên <code>scavenge</code> được kích hoạt rất thường xuyên. </p>
</li>
<li>
<p>Trong quá triển khai <code>scavenge</code>, nếu các vùng nhớ nào còn trụ lại được sau 2 chu kỳ, thì được đưa lên (promote) khu vực <code>old-space</code>, nơi mà có sức chứa lên đến hàng trăm megabytes, và là nơi mà thuật toán<code>mark-sweep</code> hoặc <code>mark-compact</code> hoạt động, với chu kỳ dài hơn, ít thường xuyên hơn.</p>
</li>
</ul>
<p>Tóm lại, cơ chế GC trên đều hoạt động thông qua hai bước chính là:</p>
<ul>
<li>
<p>Bước đánh dấu: thuật toán sẽ duyệt qua tất cả các giá trị có trong khu vực bộ nhớ mà nó quản lý, bước duyệt này dùng <code>depth-first search</code>, tìm gặp và đánh dấu.</p>
</li>
<li>
<p>Bước xử lý: sau quá trình duyệt, tất cả những giá trị chưa được đánh dấu, sẽ bị coi là đã "chết", và sẽ bị xóa bỏ, trả lại bộ nhớ trống (sweep), hoặc gom góp lại để lấy lại các khoảng trống trong bộ nhớ không sử dụng được (compact).</p>
</li>
</ul>
<h3 id="avoid-memory-leaks">Avoid Memory leaks<a class="headerlink" href="#avoid-memory-leaks" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Lý do chính của <code>memory leaks</code> trong các ngôn ngữ có cơ chế <code>garbage collection</code> là các có các <code>unwanted references</code> - là một vùng nhớ được trỏ đến mà lại không được sử dụng trong ứng dụng nhưng vì lý do nào đó mà nó vẫn được giữ lại trong hệ thống. Khi số lượng <code>unwanted references</code> nhiều, free memory không đủ để cung cấp sẽ dấn đến hượng tượng <code>memory leaks</code>.</p>
</li>
<li>
<p>Trong JS, những <code>unwanted references</code> này thường là các variables nằm đâu đó trong code và nó không được sử dụng đến nhưng lại chiếm một phần của bộ nhớ. Có 3 loại <code>memory leaks</code> trong JS:</p>
</li>
<li>
<p><code>Global variable</code>: Javascript có một cơ chế là đặt biến mà không cần khai báo. Ví dụ:
  <div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nx">a</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">;</span>
</code></pre></div></p>
</li>
<li>
<p>Khi một biến được khai báo như trên thì JS sẽ tự động gán nó vào global object (window trên browser). Nếu như biến này chỉ hoạt động trên phạm vi <code>global scope</code> thì cũng không có sự khác biệt cho lắm. Tuy nhiên, nếu nó được định nghĩa trong một hàm thì đó lại là chuyện khác. Ví dụ:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>  <span class="nx">bar</span> <span class="o">=</span> <span class="s2">&quot;đây là biến toàn cục ẩn&quot;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p>Nếu khai báo <code>bar</code> trong phạm vi của hàm <code>foo()</code> mà lại không sử dụng <code>var</code> để khai báo thì biến <code>bar</code> sẽ được tạo với <code>global scope</code>. Khi đó tuy là chỉ khi gọi hàm <code>foo()</code> thì mới cần dùng tới biến <code>bar</code>, tuy nhiên là <code>global scope</code> nên lúc nào ông <code>bar</code> cũng chiếm 1 phần bộ nhớ, và đây là một ví dụ điển hình về <code>memory leaks</code>.</p>
</li>
<li>
<p><code>Callback</code> và <code>timer</code> bị lãng quên
một ví dụ dẫn đến memory leak khi sử dụng setInterval
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">getData</span><span class="p">();</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>  <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;Node&quot;</span><span class="p">);</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>  <span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="nx">node</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">someResource</span><span class="p">));</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>  <span class="p">}</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="p">},</span> <span class="mf">1000</span><span class="p">);</span>
</code></pre></div></p>
</li>
<li>
<p><code>Timer</code> bị treo tức khi <code>timer</code> tham chiếu đến các node hoặc dữ liệu mà không còn được sử dụng nữa. Ở ví dụ trên, nếu như <code>node</code> bị xóa ở một lúc nào đấy thì toàn bộ đoạn code xử lý trong hàm <code>callback</code> của <code>interval</code> sẽ không cần đến nữa. Tuy nhiên, trường hợp node bị xóa trong khi interval vẫn còn hoạt động thì các vùng nhớ được sử dụng trong hàm callback của interval cũng không được giải phóng (muốn giải phóng cần dừng interval lại). Tiếp đó, các object từ bên ngoài mà được hàm callback của interval tham chiếu đến cũng không thể được giải phóng vì vẫn có thể được gọi thông qua hàm callback kia. Trường hợp này cũng dấn đến <code>memory leaks</code>.</p>
</li>
<li>
<p>Tham chiếu tới các DOM đã bị xóa</p>
</li>
<li>
<p>Khi cần lưu DOM vào một số cấu trúc dữ liệu như mảng hoặc object trong JS code để làm một loạt các tác vụ nào đó. </p>
</li>
<li>
<p>Ví dụ update dữ liệu của một vài DOM element nào đó, ta cần lưu các element này vào một mảng, object trong JS. </p>
</li>
<li>
<p>Nếu ta update xong ta xóa các DOM element cũ đi, khi đó node con (element) còn tham chiếu đến node cha (array, object) nên nó sẽ được GC coi là vẫn được tham chiếu và bỏ qua nó, từ đó có thể dẫn đến <code>memory leaks</code>. Nên cẩn thận khi tham chiếu đến các DOM.</p>
</li>
<li>
<p>Closures</p>
</li>
<li>
<p><code>Closures</code> là hàm nằm trong <code>scope</code> của một hàm khác có thể tham chiếu tới các biến của hàm bao nó.</p>
</li>
<li>Khi một scope được tạo ra cho các closures mà có cùng scope cha, chúng sẽ cùng chia sẻ scope đó. Mặc dù scope con không được gọi đến nhưng vì nó có tham chiếu đến scope cha nên nó sẽ được GC coi là vẫn đang hoạt động, từ đó có thể dẫn đến <code>memory leaks</code>.</li>
</ul>
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><a href="https://wentzwu.com/2020/02/23/program-process-and-thread/">program-process-and-thread</a></p>
</li>
<li>
<p><a href="https://www.geeksforgeeks.org/difference-between-process-and-thread/">Difference between Process and Thread</a></p>
</li>
<li>
<p><a href="https://nodejs.dev/learn/error-handling-in-nodejs">Error handling in Nodejs</a></p>
</li>
<li>
<p><a href="https://www.makeuseof.com/synchronous-asynchronous-programming-different/">Synchronous vs. Asynchronous Programming</a></p>
</li>
<li>
<p><a href="https://blog.risingstack.com/node-hero-async-programming-in-node-js/#asynchronousprogramminginnodejs">Node Hero – Understanding Async Programming in Node.js</a></p>
</li>
<li>
<p><a href="https://www.memorymanagement.org/glossary/g.html">Memory Management Glossary</a></p>
</li>
<li>
<p><a href="https://auth0.com/blog/four-types-of-leaks-in-your-javascript-code-and-how-to-get-rid-of-them/">4 Types of Memory Leaks in JavaScript and How to Get Rid Of Them</a></p>
</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Memory_Management">Memory Management</a></li>
</ol>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../Web-server-and-proxy/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Web server and proxy" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Web server and proxy
            </div>
          </div>
        </a>
      
      
        
        <a href="../Supervisor%20and%20workers%20management/" class="md-footer__link md-footer__link--next" aria-label="Next: Supervisord and workers management" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Supervisord and workers management
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 Harry Hoang
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "navigation.top", "navigation.tabs", "navigation.expand", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>